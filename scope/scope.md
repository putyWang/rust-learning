#### [4.1 基础定义](./base/src/main.rs)

- 基础规则
  - Rust 中的每一个值都有一个 **所有者**（*owner*）；
  - 值在任一时刻有且只有一个所有者；
  - 当所有者（变量）离开作用域，这个值将被丢弃；
- 变量作用域
  - 作用域是使用{}包含的一段代码段；
  - 作用域是一个项（item）的有效作用范围；
  - 当 `s` **进入作用域** 时，它就是有效的；
  - 这一直持续到它 **离开作用域** 为止；
- 内存分配
  - 声明变量时，程序申请变量所需内存；
  - 内存在拥有它的变量离开作用域后就被自动释放；
  - 当变量离开作用域，Rust 为我们调用 drop 函数，清除特定内存；
  - 变量赋值给另一个变量时移动出现移动，当持有堆中数据值的变量离开作用域时通过 `drop` 被清理掉，除非数据被移动为另一个变量所有；
  - **移动**
    - **二次释放**：由于存储在堆上的数据，变量名存储的是指向内存的指针，如果赋值给一个新变量，在离开作用域时释放内存的时候会出现多次释放同一位置内存的问题；
    - **移动**：使用 = 将存储在堆上的对象赋值给新变量时会使得之前的变量失效；
    - 移动之后再使用之前变量会导致编译出错（borrow of moved value: `s`）；
    - 移动之后由于旧变量已无效，已无需释放内存，因此只会释放一次内存，避免了二次释放问题；
  - **克隆**
    - 使用 clone 是将堆中的数据复制一份，新变量存储着指向复制后数据的指针；
  - **拷贝**
    - 使用 = 将存储在栈上的数据赋值给新变量就直接将栈上数据复制一份给新变量；
    - 实现copy的类型就是使用拷贝；
    - 任何一组简单标量值的组合都可以实现 `Copy`；
    - 任何不需要分配内存或某种形式资源的类型都可以实现 `Copy`；
    - 实现了copy的类型
      - 所有整数类型，比如 `u32`；
      - 布尔类型，`bool`，它的值是 `true` 和 `false`；
      - 所有浮点数类型，比如 `f64`；
      - 字符类型，`char`；
      - 当且仅当其包含的类型都实现 `Copy` 的元组；
- 所有权与函数
  - 函数传参的规则也与=赋值规则一致；
  - 对未实现copy的类型采取的就是移动的方式；
  - 当出现移动的情况时，程序编译出错（borrow of moved value: `s`）提示你这个地方产生了移动，需要你使用clone的方式进行传参；
  - 实现copy的类型采取的就是拷贝的方式；
  - 函数返回值采取的是移动的方式返回给调用它的函数；

#### [4.2 引用](./references_and_borrowing/src/main.rs)

- **基本知识**

  - 像一个指针，存储的是一个地址，能够访问储存于该地址的属于其他变量的数据；

  - 与指针不同在于引用指向的数据具有特定数据类型，不可更改；

  - 函数定义时采用 (&数据类型) 的方式表明需要传入引用，使用时则采用 (&数据名)方式表示传递指定数据的引用；

  - 引用实际上表示 可以使用该数据，但却不获取该数据的所有权；

  - 由于引用没有数据的所有权，因此在离开对应的作用域时，也不会丢弃和清理对应的数据内存；

  - 和变量默认不可变一样，引用也是默认不能被更改的；

- **可变引用**

  - 同时在传参除数据名前以及接收参数定义的类型名前添加(mut)关键字将使得我们能够在使用时修改引用对应的值；
  - 只有源数据值也是可变时，才能作为可变引用进行传参；
  - 在任意给定时刻，一个对象 **只能拥有一个可变引用或任意数量的不可变引用之一**；
  - **数据竞争**产生原因
    - 两个或更多指针同时访问同一数据；
    - 至少有一个指针被用来写入数据；
    - 没有同步数据访问的机制；

- **悬垂引用**

  - **悬垂指针**：指向的内存可能已经被分配给其它持有者；
  - 通过确保数据不会在其引用之前离开作用域来避免**悬垂引用**问题的发生；

#### [4.3 Slice 类型](./slice/src/main.rs)

-  *slice* 允许引用**集合中一段连续的元素序列**，而不用引用整个集合；
-  **字符串slice**
   - **字符串 slice**（*string slice*）是 `String` 中一部分值的引用，声明写做 &str；
   - &字符串变量名[startIndex..endIndex] 表示从该变量从startIndex到endIndex的局部引用；
   - 字符串 slice 引用包含startIndex，不包含endIndex；
   - 当 startIndex 为0时，可以省略，直接使用[..endIndex]表示从0到endIndex的局部引用；
   - 当endIndex 表示到 String 的结尾，endIndex 也可被省略；
   - 源数据出现任意改变时候会导致该数据绑定的 字符串slice 失效；
   - 字符串字面量数据类型实际上就是 字符串slice；
   - 对字符串的引用 相当于 对字符串的全量 slice；